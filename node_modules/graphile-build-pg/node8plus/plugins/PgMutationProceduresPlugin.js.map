{"version":3,"sources":["../../src/plugins/PgMutationProceduresPlugin.js"],"names":["PgMutationProceduresPlugin","builder","hook","fields","build","context","extend","pgIntrospectionResultsByKind","introspectionResultsByKind","inflection","scope","isRootMutation","fieldWithHooks","procedure","filter","proc","isStable","namespace","reduce","memo","fieldName","functionMutationName","isMutation"],"mappings":";;;;;;AAEA;;;;AACA;;;;;;kBAEgB,SAASA,0BAAT,CAAoCC,OAApC,EAA6C;AAC3DA,UAAQC,IAAR,CAAa,0BAAb,EAAyC,CAACC,MAAD,EAASC,KAAT,EAAgBC,OAAhB,KAA4B;AACnE,UAAM;AACJC,YADI;AAEJC,oCAA8BC,0BAF1B;AAGJC;AAHI,QAIFL,KAJJ;AAKA,UAAM,EAAEM,OAAO,EAAEC,cAAF,EAAT,EAA6BC,cAA7B,KAAgDP,OAAtD;AACA,QAAI,CAACM,cAAL,EAAqB;AACnB,aAAOR,MAAP;AACD;AACD,WAAOG,OACLH,MADK,EAELK,2BAA2BK,SAA3B,CACGC,MADH,CACUC,QAAQ,CAACA,KAAKC,QADxB,EAEGF,MAFH,CAEUC,QAAQ,CAAC,CAACA,KAAKE,SAFzB,EAGGH,MAHH,CAGUC,QAAQ,CAAC,oBAAKA,IAAL,EAAW,SAAX,CAHnB,EAIGG,MAJH,CAIU,CAACC,IAAD,EAAOJ,IAAP,KAAgB;AACtB;;;;;;;;;;;;;;;AAeA,YAAMK,YAAYX,WAAWY,oBAAX,CAAgCN,IAAhC,CAAlB;AACAI,WAAKC,SAAL,IAAkB,6BAAcA,SAAd,EAAyBL,IAAzB,EAA+BX,KAA/B,EAAsC;AACtDQ,sBADsD;AAEtDU,oBAAY;AAF0C,OAAtC,CAAlB;AAIA,aAAOH,IAAP;AACD,KA1BH,EA0BK,EA1BL,CAFK,EA6BJ,kDA7BI,CAAP;AA+BD,GAzCD;AA0CD,C","file":"PgMutationProceduresPlugin.js","sourcesContent":["// @flow\nimport type { Plugin } from \"graphile-build\";\nimport makeProcField from \"./makeProcField\";\nimport omit from \"../omit\";\n\nexport default (function PgMutationProceduresPlugin(builder) {\n  builder.hook(\"GraphQLObjectType:fields\", (fields, build, context) => {\n    const {\n      extend,\n      pgIntrospectionResultsByKind: introspectionResultsByKind,\n      inflection,\n    } = build;\n    const { scope: { isRootMutation }, fieldWithHooks } = context;\n    if (!isRootMutation) {\n      return fields;\n    }\n    return extend(\n      fields,\n      introspectionResultsByKind.procedure\n        .filter(proc => !proc.isStable)\n        .filter(proc => !!proc.namespace)\n        .filter(proc => !omit(proc, \"execute\"))\n        .reduce((memo, proc) => {\n          /*\n            proc =\n              { kind: 'procedure',\n                name: 'integration_webhook_secret',\n                description: null,\n                namespaceId: '6484381',\n                isStrict: false,\n                returnsSet: false,\n                isStable: true,\n                returnTypeId: '2950',\n                argTypeIds: [ '6484569' ],\n                argNames: [ 'integration' ],\n                argDefaultsNum: 0 }\n            */\n\n          const fieldName = inflection.functionMutationName(proc);\n          memo[fieldName] = makeProcField(fieldName, proc, build, {\n            fieldWithHooks,\n            isMutation: true,\n          });\n          return memo;\n        }, {}),\n      `Adding mutation procedure to root Mutation field`\n    );\n  });\n}: Plugin);\n"]}